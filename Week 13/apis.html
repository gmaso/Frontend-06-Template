<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div class="result"></div>

  <script>
    // 分类浏览器中的所有 API

    // 获取当前环境的所有属性名称
    let names = Object.getOwnPropertyNames(globalThis);
    let resultDom = document.querySelector('.result');

    function filterOut(names, specObj) {
      let specTitle = specObj.spec || '';
      let p;
      p = document.createElement('p');
      p.innerHTML = '规范：' + specTitle;
      resultDom.append(p);
      if (specObj.filter) {
        p = document.createElement('p');
        p.innerHTML = '属性提取：' + specObj.filter;
        resultDom.append(p);
      }
      let specNames = specObj.names || [];
      p = document.createElement('p');
      let newNames;
      if (specObj.filterFunc) {
        specNames = names.filter(name => specObj.filterFunc(name));
        newNames = names.filter(name => !specObj.filterFunc(name));
      } else {
        let map = new Map();
        specNames.map(name => map.set(name));
        newNames = names.filter(name => !map.has(name));
      }
      p.innerHTML = '属性(共' + specNames.length + '个)：' + specNames.join(', ') + '<br><br>'
      resultDom.append(p);
      return newNames;
    }

    // ECMA 262 标准中的属性
    names = filterOut(names, {
      spec: 'https://262.ecma-international.org/11.0/',
      filter: "[...document.querySelectorAll('h1')].filter(ele => /^(18\.\d+\.(\d+\s|6\.[2345])|b\.2\.1\.)/i.test(ele.innerText)).map(ele => ele.innerText.split(' ')[1])",
      names: ["globalThis", "Infinity", "NaN", "undefined", "eval", "isFinite", "isNaN", "parseFloat", "parseInt", "URI", "decodeURI", "decodeURIComponent", "encodeURI", "encodeURIComponent", "Array", "ArrayBuffer", "BigInt", "BigInt64Array", "BigUint64Array", "Boolean", "DataView", "Date", "Error", "EvalError", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Number", "Object", "Promise", "Proxy", "RangeError", "ReferenceError", "RegExp", "Set", "SharedArrayBuffer", "String", "Symbol", "SyntaxError", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "URIError", "WeakMap", "WeakSet", "Atomics", "JSON", "Math", "Reflect", "escape", "unescape"]
    });

    // console
    names = filterOut(names, {
      spec: 'console',
      names: ["console"]
    });

    // intl
    names = filterOut(names, {
      spec: 'https://tc39.es/ecma402/#intl-object',
      names: ["Intl"]
    });

    // webkit 标准中的属性
    names = filterOut(names, {
      spec: 'webkit',
      filterFunc: name => /^webkit/i.test(name)
    });
    
    // webkit 标准中的属性
    names = filterOut(names, {
      spec: 'webGL',
      filterFunc: name => /^webgl/i.test(name)
    });

    // DOM
    names = filterOut(names, {
      spec: 'DOM',
      filterFunc: name => /^DOM/i.test(name)
    });

    // html
    names = filterOut(names, {
      spec: 'HTML',
      filterFunc: name => /^html/i.test(name)
    });
    
    // svg
    names = filterOut(names, {
      spec: 'SVG',
      filterFunc: name => /^svg/i.test(name)
    });

    // 事件
    names = filterOut(names, {
      spec: '事件',
      filterFunc: name => /^on/i.test(name)
    });
    
    // CSS
    names = filterOut(names, {
      spec: 'CSS',
      filterFunc: name => /^css/i.test(name)
    });
    
    // Audio
    names = filterOut(names, {
      spec: 'Audio',
      filterFunc: name => /^Audio/i.test(name)
    });
    
    // Performance
    names = filterOut(names, {
      spec: 'Performance',
      filterFunc: name => /^Performance/i.test(name)
    });
    
    // Bluetooth
    names = filterOut(names, {
      spec: 'Bluetooth',
      filterFunc: name => /^Bluetooth/i.test(name)
    });
    
    // Cookie
    names = filterOut(names, {
      spec: 'Cookie',
      filterFunc: name => /^Cookie/i.test(name)
    });
    
    // RTC
    names = filterOut(names, {
      spec: 'RTC',
      filterFunc: name => /^RTC/i.test(name)
    });
    
    // Payment
    names = filterOut(names, {
      spec: 'Payment',
      filterFunc: name => /^Payment/i.test(name)
    });

    console.log(names);
    let p;
    p = document.createElement('p');
    p.innerHTML = '剩余属性(共' + names.length + '个)：' + names.join(', ');
    resultDom.append(p);
  </script>
</body>
</html>